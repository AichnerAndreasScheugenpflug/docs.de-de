---
title: Importieren einer Typbibliothek als Assembly
ms.date: 03/30/2017
helpviewer_keywords:
- importing type library
- type metadata
- custom wrappers
- metadata
- exposing COM components to .NET Framework
- Type Library Importer
- interoperation with unmanaged code, importing type library
- interoperation with unmanaged code, exposing COM components
- type libraries
- TypeLibConverter class, importing type library as assembly
- COM interop, importing type library
- COM interop, exposing COM components
ms.assetid: d1898229-cd40-426e-a275-f3eb65fbc79f
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 3e346b326255ea46babc2e4c9101a1724671514d
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 01/23/2019
ms.locfileid: "54517567"
---
# <a name="importing-a-type-library-as-an-assembly"></a><span data-ttu-id="1595f-102">Importieren einer Typbibliothek als Assembly</span><span class="sxs-lookup"><span data-stu-id="1595f-102">Importing a Type Library as an Assembly</span></span>
<span data-ttu-id="1595f-103">Definitionen von COM-Typen befinden sich in der Regel in einer Typbibliothek.</span><span class="sxs-lookup"><span data-stu-id="1595f-103">COM type definitions usually reside in a type library.</span></span> <span data-ttu-id="1595f-104">Im Gegensatz dazu erzeugen CLS-kompatible Compiler Typmetadaten in einer Assembly.</span><span class="sxs-lookup"><span data-stu-id="1595f-104">In contrast, CLS-compliant compilers produce type metadata in an assembly.</span></span> <span data-ttu-id="1595f-105">Die zwei Quellen von Typinformationen sind sehr unterschiedlich.</span><span class="sxs-lookup"><span data-stu-id="1595f-105">The two sources of type information are quite different.</span></span> <span data-ttu-id="1595f-106">In diesem Thema werden Techniken zum Generieren von Metadaten aus einer Typbibliothek beschrieben.</span><span class="sxs-lookup"><span data-stu-id="1595f-106">This topic describes techniques for generating metadata from a type library.</span></span> <span data-ttu-id="1595f-107">Die sich ergebende Assembly wird Interop-Assembly genannt, und die darin enthaltenen Typinformationen erlauben .NET Framework-Anwendungen die Verwendung von COM-Typen.</span><span class="sxs-lookup"><span data-stu-id="1595f-107">The resulting assembly is called an interop assembly, and the type information it contains enables .NET Framework applications to use COM types.</span></span>  
  
 <span data-ttu-id="1595f-108">Es gibt zwei Möglichkeiten, um diese Typinformationen für Ihre Anwendung verfügbar zu machen:</span><span class="sxs-lookup"><span data-stu-id="1595f-108">There are two ways to make this type information available to your application:</span></span>  
  
-   <span data-ttu-id="1595f-109">Mithilfe der Interopassemblys, die nur zur Entwurfszeit verwendet werden: Beginnend mit der [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], können Sie den Compiler anweisen, die Typinformationen aus einer Interopassembly in die ausführbare Datei einzubetten.</span><span class="sxs-lookup"><span data-stu-id="1595f-109">Using design-time-only interop assemblies: Beginning with the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], you can instruct the compiler to embed type information from the interop assembly into your executable.</span></span> <span data-ttu-id="1595f-110">Der Compiler bettet nur die Typinformationen ein, die Ihre Anwendung verwendet.</span><span class="sxs-lookup"><span data-stu-id="1595f-110">The compiler embeds only the type information that your application uses.</span></span> <span data-ttu-id="1595f-111">Sie müssen die Interop-Assembly nicht mit Ihrer Anwendung bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="1595f-111">You do not have to deploy the interop assembly with your application.</span></span> <span data-ttu-id="1595f-112">Dies ist das empfohlene Verfahren.</span><span class="sxs-lookup"><span data-stu-id="1595f-112">This is the recommended technique.</span></span>  
  
-   <span data-ttu-id="1595f-113">Bereitstellen von Interopassemblys: So können Sie einen Standardverweis auf eine Interopassembly erstellen.</span><span class="sxs-lookup"><span data-stu-id="1595f-113">Deploying interop assemblies: You can create a standard reference to the interop assembly.</span></span> <span data-ttu-id="1595f-114">In diesem Fall muss die Interop-Assembly mit Ihrer Anwendung bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="1595f-114">In this case, the interop assembly must be deployed with your application.</span></span> <span data-ttu-id="1595f-115">Wenn Sie dieses Verfahren ohne eine private COM-Komponente verwenden, verweisen Sie immer auf die primäre Interop-Assembly (PIA), die vom Autor der COM-Komponente veröffentlicht wurde, die Sie in Ihren verwalteten Code einbetten möchten.</span><span class="sxs-lookup"><span data-stu-id="1595f-115">If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code.</span></span> <span data-ttu-id="1595f-116">Weitere Informationen zum Erstellen und Verwenden von primären Interop-Assemblys finden Sie unter [Primäre Interop-Assemblys](https://msdn.microsoft.com/library/b977a8be-59a0-40a0-a806-b11ffba5c080(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="1595f-116">For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://msdn.microsoft.com/library/b977a8be-59a0-40a0-a806-b11ffba5c080(v=vs.100)).</span></span>  
  
 <span data-ttu-id="1595f-117">Wenn Sie Interop-Assemblys nur zur Entwurfszeit verwenden, können Sie Typinformationen aus der primären Interop-Assembly einbetten, die vom Autor der COM-Komponente veröffentlicht wurden.</span><span class="sxs-lookup"><span data-stu-id="1595f-117">When you use design-time-only interop assemblies, you can embed type information from the primary interop assembly published by the author of the COM component.</span></span> <span data-ttu-id="1595f-118">Sie müssen jedoch die primäre Interop-Assembly nicht mit Ihrer Anwendung bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="1595f-118">However, you do not have to deploy the primary interop assembly with your application.</span></span>  
  
 <span data-ttu-id="1595f-119">Das Verwenden von Interop-Assemblys nur zur Entwurfszeit reduziert die Größe Ihrer Anwendung, da die meisten Anwendungen nicht alle Funktionen einer COM-Komponente verwenden.</span><span class="sxs-lookup"><span data-stu-id="1595f-119">Using design-time-only interop assemblies reduces the size of your application, because most applications do not use all the features of a COM component.</span></span> <span data-ttu-id="1595f-120">Der Compiler ist sehr effizient, wenn er Typinformationen einbettet. Wenn Ihre Anwendung nur einige der Methoden auf einer COM-Schnittstelle verwendet, bettet der Compiler die nicht verwendeten Methoden nicht ein.</span><span class="sxs-lookup"><span data-stu-id="1595f-120">The compiler is very efficient when it embeds type information; if your application uses only some of the methods on a COM interface, the compiler does not embed the unused methods.</span></span> <span data-ttu-id="1595f-121">Wenn eine Anwendung mit eingebetteten Typinformationen mit einer anderen Anwendung dieser Art oder mit einer Anwendung interagiert, die eine primäre Interop-Assembly verwendet, nutzt die Common Language Runtime Typäquivalenzregeln, um zu bestimmen, ob zwei Typen mit dem gleichen Namen denselben COM-Typ darstellen.</span><span class="sxs-lookup"><span data-stu-id="1595f-121">When an application that has embedded type information interacts with another such application, or interacts with an application that uses a primary interop assembly, the common language runtime uses type equivalence rules to determine whether two types with the same name represent the same COM type.</span></span> <span data-ttu-id="1595f-122">Sie müssen diese Regeln nicht kennen, um COM-Objekte zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="1595f-122">You do not have to know these rules to use COM objects.</span></span> <span data-ttu-id="1595f-123">Wenn Sie jedoch an diesen Regeln interessiert sind, finden Sie weitere Informationen unter [Type Equivalence and Embedded Interop Types (Typäquivalenz und eingebettete Interop-Typen)](../../../docs/framework/interop/type-equivalence-and-embedded-interop-types.md).</span><span class="sxs-lookup"><span data-stu-id="1595f-123">However, if you are interested in the rules, see [Type Equivalence and Embedded Interop Types](../../../docs/framework/interop/type-equivalence-and-embedded-interop-types.md).</span></span>  
  
## <a name="generating-metadata"></a><span data-ttu-id="1595f-124">Generieren von Metadaten</span><span class="sxs-lookup"><span data-stu-id="1595f-124">Generating Metadata</span></span>  
 <span data-ttu-id="1595f-125">Bei COM-Typbibliotheken kann es sich um eigenständige Dateien handeln, die die Erweiterung „.tlb“ (z.B. „Loanlib.tlb“) aufweisen.</span><span class="sxs-lookup"><span data-stu-id="1595f-125">COM type libraries can be stand-alone files that have a .tlb extension, such as Loanlib.tlb.</span></span> <span data-ttu-id="1595f-126">Einige Typbibliotheken werden im Ressourcenabschnitt einer DLL- oder EXE-Datei eingebettet.</span><span class="sxs-lookup"><span data-stu-id="1595f-126">Some type libraries are embedded in the resource section of a .dll or .exe file.</span></span> <span data-ttu-id="1595f-127">Andere Quellen von Typbibliotheksinformationen sind OLB- und OCX-Dateien.</span><span class="sxs-lookup"><span data-stu-id="1595f-127">Other sources of type library information are .olb and .ocx files.</span></span>  
  
 <span data-ttu-id="1595f-128">Nachdem Sie die Typbibliothek gesucht haben, die die Implementierung des Ziel-COM-Typs enthält, haben Sie die folgenden Optionen zum Generieren einer Interop-Assembly, die Typmetadaten enthält:</span><span class="sxs-lookup"><span data-stu-id="1595f-128">After you locate the type library that contains the implementation of your target COM type, you have the following options for generating an interop assembly containing type metadata:</span></span>  
  
-   <span data-ttu-id="1595f-129">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="1595f-129">Visual Studio</span></span>  
  
     <span data-ttu-id="1595f-130">Visual Studio konvertiert COM-Typen automatisch in einer Typbibliothek in Metadaten in einer Assembly.</span><span class="sxs-lookup"><span data-stu-id="1595f-130">Visual Studio automatically converts COM types in a type library to metadata in an assembly.</span></span> <span data-ttu-id="1595f-131">Anweisungen hierzu finden Sie unter [Vorgehensweise: Hinzufügen von Verweisen zu Typbibliotheken](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md) und [Exemplarische Vorgehensweise: Einbetten von Typinformationen aus Microsoft Office-Assemblys](https://msdn.microsoft.com/library/85b55e05-bc5e-4665-b6ae-e1ada9299fd3(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="1595f-131">For instructions, see [How to: Add References to Type Libraries](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md) and [Walkthrough: Embedding Type Information from Microsoft Office Assemblies](https://msdn.microsoft.com/library/85b55e05-bc5e-4665-b6ae-e1ada9299fd3(v=vs.100)).</span></span>  
  
-   [<span data-ttu-id="1595f-132">Tlbimp.exe (Type Library Importer-Tool)</span><span class="sxs-lookup"><span data-stu-id="1595f-132">Type Library Importer (Tlbimp.exe)</span></span>](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)  
  
     <span data-ttu-id="1595f-133">Das Type Library Importer-Tool stellt Befehlszeilenoptionen zum Anpassen von Metadaten in der resultierenden Interop-Datei zur Verfügung, importiert Typen aus einer vorhandenen Typbibliothek und generiert eine Interop-Assembly und einen Namespace.</span><span class="sxs-lookup"><span data-stu-id="1595f-133">The Type Library Importer provides command-line options to adjust metadata in the resulting interop file, imports types from an existing type library, and generates an interop assembly and a namespace.</span></span> <span data-ttu-id="1595f-134">Anweisungen hierzu finden Sie unter [Vorgehensweise: Generieren von Interopassemblys aus Typbibliotheken](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="1595f-134">For instructions, see [How to: Generate Interop Assemblies from Type Libraries](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md).</span></span>  
  
-   <span data-ttu-id="1595f-135"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType>-Klasse</span><span class="sxs-lookup"><span data-stu-id="1595f-135"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> class</span></span>  
  
     <span data-ttu-id="1595f-136">Diese Klasse stellt Methoden zum Konvertieren von Co-Klassen und Schnittstellen in einer Typbibliothek in Metadaten in einer Assembly bereit.</span><span class="sxs-lookup"><span data-stu-id="1595f-136">This class provides methods to convert coclasses and interfaces in a type library to metadata within an assembly.</span></span> <span data-ttu-id="1595f-137">Sie erzeugt dieselbe Metadatenausgabe wie „Tlbimp.exe“.</span><span class="sxs-lookup"><span data-stu-id="1595f-137">It produces the same metadata output as Tlbimp.exe.</span></span> <span data-ttu-id="1595f-138">Anders als bei „Tlbimp.exe“, kann die <xref:System.Runtime.InteropServices.TypeLibConverter>-Klasse eine In-Memory-Typbibliothek in Metadaten konvertieren.</span><span class="sxs-lookup"><span data-stu-id="1595f-138">However, unlike Tlbimp.exe, the <xref:System.Runtime.InteropServices.TypeLibConverter> class can convert an in-memory type library to metadata.</span></span>  
  
-   <span data-ttu-id="1595f-139">Benutzerdefinierte Wrapper</span><span class="sxs-lookup"><span data-stu-id="1595f-139">Custom wrappers</span></span>  
  
     <span data-ttu-id="1595f-140">Wenn eine Typbibliothek falsch oder nicht verfügbar ist, ist eine Option das Erstellen einer doppelten Definition der Klasse oder Schnittstelle in verwaltetem Quellcode.</span><span class="sxs-lookup"><span data-stu-id="1595f-140">When a type library is unavailable or incorrect, one option is to create a duplicate definition of the class or interface in managed source code.</span></span> <span data-ttu-id="1595f-141">Anschließend kompilieren Sie den Quellcode mit einem Compiler, der die Runtime zur Erstellung von Metadaten in einer Assembly anzielt.</span><span class="sxs-lookup"><span data-stu-id="1595f-141">You then compile the source code with a compiler that targets the runtime to produce metadata in an assembly.</span></span>  
  
     <span data-ttu-id="1595f-142">Um COM-Typen manuell zu definieren, benötigen Sie Zugriff auf die folgenden Elemente:</span><span class="sxs-lookup"><span data-stu-id="1595f-142">To define COM types manually, you must have access to the following items:</span></span>  
  
    -   <span data-ttu-id="1595f-143">Genaue Beschreibungen der Co-Klassen und -Schnittstellen, die definiert werden.</span><span class="sxs-lookup"><span data-stu-id="1595f-143">Precise descriptions of the coclasses and interfaces being defined.</span></span>  
  
    -   <span data-ttu-id="1595f-144">Einen Compiler, z.B. den C#-Compiler, der die entsprechenden .NET Framework-Klassendefinitionen generieren kann.</span><span class="sxs-lookup"><span data-stu-id="1595f-144">A compiler, such as the C# compiler, that can generate the appropriate .NET Framework class definitions.</span></span>  
  
    -   <span data-ttu-id="1595f-145">Kenntnisse der Konvertierungsregeln einer Typbibliothek in eine Assembly.</span><span class="sxs-lookup"><span data-stu-id="1595f-145">Knowledge of the type library-to-assembly conversion rules.</span></span>  
  
     <span data-ttu-id="1595f-146">Das Schreiben eines benutzerdefinierten Wrappers ist ein erweitertes Verfahren.</span><span class="sxs-lookup"><span data-stu-id="1595f-146">Writing a custom wrapper is an advanced technique.</span></span> <span data-ttu-id="1595f-147">Weitere Informationen zum Generieren von benutzerdefinierten Wrappern finden Sie unter [Anpassen von Standardwrappern](https://msdn.microsoft.com/library/c40d089b-6a3c-41b5-a20d-d760c215e49d(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="1595f-147">For additional information about how to generate a custom wrapper, see [Customizing Standard Wrappers](https://msdn.microsoft.com/library/c40d089b-6a3c-41b5-a20d-d760c215e49d(v=vs.100)).</span></span>  
  
 <span data-ttu-id="1595f-148">Weitere Informationen zum COM-Interop-Importvorgang finden Sie unter [Zusammenfassung: Konvertieren einer Typbibliothek in eine Assembly](https://msdn.microsoft.com/library/bf3f90c5-4770-4ab8-895c-3ba1055cc958(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="1595f-148">For more information about the COM interop import process, see [Type Library to Assembly Conversion Summary](https://msdn.microsoft.com/library/bf3f90c5-4770-4ab8-895c-3ba1055cc958(v=vs.100)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1595f-149">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="1595f-149">See also</span></span>
- <xref:System.Runtime.InteropServices.TypeLibConverter>
- [<span data-ttu-id="1595f-150">Verfügbarmachen von COM-Komponenten für .NET Framework</span><span class="sxs-lookup"><span data-stu-id="1595f-150">Exposing COM Components to the .NET Framework</span></span>](../../../docs/framework/interop/exposing-com-components.md)
- <span data-ttu-id="1595f-151">[Zusammenfassung: Konvertieren einer Typbibliothek in eine Assembly](https://msdn.microsoft.com/library/bf3f90c5-4770-4ab8-895c-3ba1055cc958(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="1595f-151">[Type Library to Assembly Conversion Summary](https://msdn.microsoft.com/library/bf3f90c5-4770-4ab8-895c-3ba1055cc958(v=vs.100))</span></span>
- [<span data-ttu-id="1595f-152">Tlbimp.exe (Type Library Importer-Tool)</span><span class="sxs-lookup"><span data-stu-id="1595f-152">Tlbimp.exe (Type Library Importer)</span></span>](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)
- <span data-ttu-id="1595f-153">[Anpassen von Standardwrappern](https://msdn.microsoft.com/library/c40d089b-6a3c-41b5-a20d-d760c215e49d(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="1595f-153">[Customizing Standard Wrappers](https://msdn.microsoft.com/library/c40d089b-6a3c-41b5-a20d-d760c215e49d(v=vs.100))</span></span>
- <span data-ttu-id="1595f-154">[Verwenden von COM-Typen in verwaltetem Code](https://msdn.microsoft.com/library/1a95a8ca-c8b8-4464-90b0-5ee1a1135b66(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="1595f-154">[Using COM Types in Managed Code](https://msdn.microsoft.com/library/1a95a8ca-c8b8-4464-90b0-5ee1a1135b66(v=vs.100))</span></span>
- [<span data-ttu-id="1595f-155">Kompilieren eines Interop-Projekts</span><span class="sxs-lookup"><span data-stu-id="1595f-155">Compiling an Interop Project</span></span>](../../../docs/framework/interop/compiling-an-interop-project.md)
- [<span data-ttu-id="1595f-156">Bereitstellen einer Interop-Anwendung</span><span class="sxs-lookup"><span data-stu-id="1595f-156">Deploying an Interop Application</span></span>](../../../docs/framework/interop/deploying-an-interop-application.md)
- [<span data-ttu-id="1595f-157">Vorgehensweise: Hinzufügen von Verweisen zu Typbibliotheken</span><span class="sxs-lookup"><span data-stu-id="1595f-157">How to: Add References to Type Libraries</span></span>](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md)
- [<span data-ttu-id="1595f-158">Vorgehensweise: Generieren von Interopassemblys aus Typbibliotheken</span><span class="sxs-lookup"><span data-stu-id="1595f-158">How to: Generate Interop Assemblies from Type Libraries</span></span>](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md)
- <span data-ttu-id="1595f-159">[Exemplarische Vorgehensweise: Einbetten von Typinformationen aus Microsoft Office-Assemblys in Visual Studio](https://msdn.microsoft.com/library/85b55e05-bc5e-4665-b6ae-e1ada9299fd3(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="1595f-159">[Walkthrough: Embedding Type Information from Microsoft Office Assemblies](https://msdn.microsoft.com/library/85b55e05-bc5e-4665-b6ae-e1ada9299fd3(v=vs.100))</span></span>
